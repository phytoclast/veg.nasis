library("terra")
library("raster")
#terra version 1.2.13
fnz <- "nz_elev.rda"
if (!file.exists(fnz)) {
download.file("https://github.com/Nowosad/spDataLarge/raw/master/data/nz_elev.rda", fnz, mode = "wb")
}
load("nz_elev.rda")
nz <- rast(nz_elev)
plot(nz)
c
c=1
b=2
a=b
b=c
c
Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS" = "true")
remotes::install_github("rspatial/terra")
install.packages("remotes")
Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS" = "true")
remotes::install_github("rspatial/terra")
remotes::install_github("rspatial/raster")
Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS" = "true")
remotes::install_github("rspatial/terra")
install.packages("Rcpp")
Sys.setenv("R_REMOTES_NO_ERRORS_FROM_WARNINGS" = "true")
remotes::install_github("rspatial/terra")
remotes::install_github("rspatial/raster")
install.packages(c("igraph", "insight"))
install.packages(c("car", "commonmark", "cpp11", "data.table", "digest", "e1071", "insight", "jsonlite", "maptools", "markdown", "minqa", "openssl", "protolite", "rlas", "soilDB", "sys", "vctrs", "vegan", "wk", "xfun", "yaml"))
library(sf)
library(terra)
library(dplyr)
worldhydro <- rast('C:/Users/greg.schmidt/Downloads/Global_Hydrologic_Soil_Group_1566/Global_Hydrologic_Soil_Group_1566/data/HYSOGs250m.tif')
install.packages(c("Matrix", "oai", "plyr", "rredlist"))
worldhydro1 <- worldhydro %>% ifel(worldhydro >= 10, 1,0)
worldhydro1
worldhydro
Tw <- rast('D:/scripts/processclimategrids/output/Tw.tif')
Tw
library(sf)
library(terra)
library(dplyr)
worldhydro <- rast('C:/Users/greg.schmidt/Downloads/Global_Hydrologic_Soil_Group_1566/Global_Hydrologic_Soil_Group_1566/data/HYSOGs250m.tif')
worldhydro1 <- ifel(worldhydro >= 10, 1,0)
writeRaster(worldhydro1, 'D:/scripts/processclimategrids/output/hydric250.tif', overwrite=TRUE)
worldhydro1
hydric5km <-  worldhydro1 %>% aggregate(fact=5, fun="mean", na.rm=TRUE,
filename= 'D:/scripts/processclimategrids/output/hydric5km.tif', overwrite=TRUE)
hydric5km
Tw
hydric1km <-  worldhydro1 %>% aggregate(fact=5, fun="mean", na.rm=TRUE,
filename= 'D:/scripts/processclimategrids/output/hydric1km.tif', overwrite=TRUE)
hydric5km <- hydric1km %>% aggregate(fact=5, fun="mean", na.rm=TRUE) %>% project(Tw) %>% writeRaster(filename= 'D:/scripts/processclimategrids/output/hydric5km.tif', overwrite=TRUE)
hydric5km
plot(hydric5km)
hydric5km <- hydric1km %>% aggregate(fact=3, fun="mean", na.rm=TRUE) %>% project(Tw, filename= 'D:/scripts/processclimategrids/output/hydric5km.tif', overwrite=TRUE)
library(soilDB)
library(aqp)
library(sharpshootR)
library(dplyr)
veg <- soilDB::get_veg_data_from_NASIS_db()
View(veg)
veg1 <- veg[1]
View(veg1)
veg1 <- veg$veg
View(veg)
View(veg1)
veg.trans <- veg$vegtransect
View(veg.trans)
library(soilDB)
library(aqp)
library(sharpshootR)
library(dplyr)
veg <- soilDB::get_veg_data_from_NASIS_db()
veg.veg <- veg$veg
veg.trans <- veg$vegtransect
View(veg.veg)
climdata <- c('Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp
1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
library(stringr)
climdata.parse <- matrix(scan(text = climdata),nrow = 12,byrow = TRUE)
ronamestr <- 'Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp'
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
climdata.parse <- matrix(scan(text = climdata),nrow = 12,byrow = TRUE)
View(climdata.parse)
rowname.parse <- matrix(scan(text = ronamestr),nrow = 12,byrow = TRUE)
rowname.parse <- scan(text = ronamestr)
rowname.parse <- scan(text = ronamestr, what = 'character')
View(climdata.parse)
climdata.parse <- climdata %>% scan() data.frame(nrow = 12,byrow = TRUE)
climdata.parse <- climdata %>% scan() %>% data.frame(nrow = 12,byrow = TRUE)
climdata.parse <- climdata %>% scan() %>% matrix(nrow = 12,byrow = TRUE)
climdata.parse <- climdata %>% scan()
View(climdata.parse)
ronamestr <- 'Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp'
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
climdata.parse <- climdata %>% scan()
library(soilDB)
library(aqp)
library(sharpshootR)
library(dplyr)
climdata.parse <- scan(climdata)
climdata.parse <- scan(text = climdata)
climdata.parse <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE)
climdata.parse <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% colnames() = rowname.parse
rowname.parse <- scan(text = ronamestr, what = 'character')
climdata.parse <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% colnames() = rowname.parse
climdata.parse <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% as.data.frame() %>% colnames() = rowname.parse
climdata.parse <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% as.data.frame()
View(climdata.parse)
colnames(climdata.parse) = rowname.parse
View(climdata.parse)
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
rowname.parse <- scan(text = ronamestr, what = 'character')
ronamestr <- 'Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp'
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
rowname.parse <- scan(text = ronamestr, what = 'character')
climdata <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% as.data.frame()
colnames(climdata) = rowname.parse
PET <- climdata$e
PPT <- climdata$p
soilM <- sharpshootR::monthlyWB(150, PPT = PPT, PET=PET)
install.packages("hydromad")
ronamestr <- 'Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp'
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
rowname.parse <- scan(text = ronamestr, what = 'character')
climdata <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% as.data.frame()
colnames(climdata) = rowname.parse
PET <- climdata$e
PPT <- climdata$p
soilM <- sharpshootR::monthlyWB(150, PPT = PPT, PET=PET)
install.packages(c("cli", "curl", "evaluate", "httpuv", "lwgeom", "odbc", "parallelly", "pbapply", "purrr", "raster", "RcppArmadillo", "rgdal", "s2", "stringi", "svglite", "terra"))
library(soilDB)
library(aqp)
library(sharpshootR)
library(dplyr)
ronamestr <- 'Mon	t	th	tl	p	e	Dl	Ra	Rn	RH	Vp'
climdata <- c('1.00	-5.69	-1.66	-9.72	46.45	2.36	9.38	12.87	1.39	73.09	0.29
2.00	-4.60	-0.09	-9.11	35.57	3.90	10.46	18.10	3.31	70.63	0.31
3.00	1.21	6.15	-3.74	65.27	10.74	11.88	25.85	5.99	69.50	0.46
4.00	7.99	13.94	2.04	85.33	48.96	13.40	34.23	9.04	66.02	0.71
5.00	14.40	20.98	7.82	80.93	88.01	14.68	40.35	11.72	64.59	1.06
6.00	19.65	26.16	13.14	94.30	105.80	15.33	43.05	13.05	66.06	1.51
7.00	22.18	28.46	15.90	80.45	115.94	15.00	41.72	12.88	64.86	1.73
8.00	20.97	27.15	14.79	92.04	100.42	13.85	36.50	10.71	67.14	1.67
9.00	16.48	22.57	10.39	107.93	68.56	12.38	28.66	7.32	67.22	1.26
10.00	10.04	15.75	4.32	72.05	42.13	10.88	20.30	4.09	67.56	0.83
11.00	3.59	7.98	-0.80	83.68	9.05	9.63	13.98	1.78	72.92	0.58
12.00	-2.72	0.93	-6.37	71.58	1.88	9.02	11.35	0.91	75.87	0.38')
rowname.parse <- scan(text = ronamestr, what = 'character')
climdata <- scan(text = climdata)  %>% matrix(nrow = 12, byrow = TRUE) %>% as.data.frame()
colnames(climdata) = rowname.parse
PET <- climdata$e
PPT <- climdata$p
soilM <- sharpshootR::monthlyWB(150, PPT = PPT, PET=PET)
install.packages("hydromad")
library(soilDB)
library(aqp)
library(sharpshootR)
library(dplyr)
install.packages(c("zoo", "latticeExtra", "polynom", "car", "Hmisc","reshape"))
install.packages("hydromad", repos="http://hydromad.catchment.org")
install.packages(c("zoo", "latticeExtra", "polynom", "car", "Hmisc","reshape"))
install.packages("hydromad", repos="http://hydromad.catchment.org")
veg <- soilDB::get_NASIS_table_name_by_purpose()
veg
veg <- soilDB::get_NASIS_table_name_by_purpose(purpose = 'vegetation')
veg
veg$vegplot
veg['vegplot']
veg[['vegplot']]
veg <- soilDB::get_NASIS_table_name_by_purpose(purpose = 'vegplot')
library(soilDB)
library(stringr)
library(dplyr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
veg.plot <- soilDB::get_vegplot_from_NASIS_db()
veg.data <- soilDB::get_veg_data_from_NASIS_db()
veg.loc <- soilDB::get_vegplot_location_from_NASIS_db()
veg.spp <- soilDB::get_vegplot_species_from_NASIS_db()
veg.data.veg <- veg.data$veg
veg.data.trans <- veg.data$vegtransect
saveRDS(veg.plot, 'data/veg.plot.RDS')
saveRDS(veg.data, 'data/veg.data.RDS')
saveRDS(veg.loc, 'data/veg.loc.RDS')
saveRDS(veg.spp, 'data/veg.spp.RDS')
saveRDS(veg.data.veg, 'data/veg.data.veg.RDS')
saveRDS(veg.data.trans, 'data/veg.data.trans.RDS')
library(soilDB)
library(stringr)
library(dplyr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
veg.plot <- readRDS('data/veg.plot.RDS')
veg.data <-  readRDS('data/veg.data.RDS')
veg.loc <-  readRDS('data/veg.loc.RDS')
veg.spp <-  readRDS('data/veg.spp.RDS')
veg.data.veg <-  readRDS('data/veg.data.veg.RDS')
veg.data.trans <-  readRDS('data/veg.data.trans.RDS')
View(veg.data.veg)
View(veg.spp)
View(veg.plot)
colnames(veg.spp)
View(veg.spp)
veg.plot <- soilDB::get_vegplot_from_NASIS_db()
veg.data <- soilDB::get_veg_data_from_NASIS_db()
veg.loc <- soilDB::get_vegplot_location_from_NASIS_db()
veg.spp <- soilDB::get_vegplot_species_from_NASIS_db()
veg.data.veg <- veg.data$veg
veg.data.trans <- veg.data$vegtransect
saveRDS(veg.plot, 'data/veg.plot.RDS')
saveRDS(veg.data, 'data/veg.data.RDS')
saveRDS(veg.loc, 'data/veg.loc.RDS')
saveRDS(veg.spp, 'data/veg.spp.RDS')
saveRDS(veg.data.veg, 'data/veg.data.veg.RDS')
saveRDS(veg.data.trans, 'data/veg.data.trans.RDS')
veg.plot <- readRDS('data/veg.plot.RDS')
veg.data <-  readRDS('data/veg.data.RDS')
veg.loc <-  readRDS('data/veg.loc.RDS')
veg.spp <-  readRDS('data/veg.spp.RDS')
veg.data.veg <-  readRDS('data/veg.data.veg.RDS')
veg.data.trans <-  readRDS('data/veg.data.trans.RDS')
View(veg.spp)
test <- veg_summary(veg_df = ecositer::vegetation_dataframe)
library(ecositer)
test <- veg_summary(veg_df = ecositer::vegetation_dataframe)
test.R022AB006CA <- test$R022AB006CA$Raw_data
View(test.R022AB006CA)
colnames(veg.spp)
x <- subset(veg.spp, select = c(vegplotiid, plantsym, plantsciname, planttypegroup, plantnativity, plantheightcllowerlimit, plantheightclupperlimit, livecanopyhtbottom, livecanopyhttop,
overstorydbhmin, overstorydbhmax, speciestraceamtflag,
speciescancovpct, speciescancovclass, speciescomppct, speciescompbywtpct,
akstratumcoverclass, akstratumcoverclasspct))
View(x)
unique(x$speciescancovclass)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
speciescancovclass %in% "> 95%" ~ (95+100)/2)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
speciescancovclass %in% "\> 95%" ~ (95+100)/2),
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
speciescancovclass %in% "\\> 95%" ~ (95+100)/2),
TRUE ~ NA)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA))
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct + ifelse(speciestraceamtflag,0.2,0),
# speciescancovclass %in% "trace" ~ 0.05,
# speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
# speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
# speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
# speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
# speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
# speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
# speciescancovclass %in% "51 to 75" ~ (50+75)/2,
# speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA))
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct,# + ifelse(speciestraceamtflag,0.2,0),
# speciescancovclass %in% "trace" ~ 0.05,
# speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
# speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
# speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
# speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
# speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
# speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
# speciescancovclass %in% "51 to 75" ~ (50+75)/2,
# speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA))
rlang::last_error()
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct))
x <- 1:50
case_when(
x %% 35 == 0 ~ "fizz buzz",
x %% 5 == 0 ~ "fizz",
x %% 7 == 0 ~ "buzz",
TRUE ~ as.character(x)
)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct,# + ifelse(speciestraceamtflag,0.2,0),
# speciescancovclass %in% "trace" ~ 0.05,
# speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
# speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
# speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
# speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
# speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
# speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
# speciescancovclass %in% "51 to 75" ~ (50+75)/2,
# speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA))
x <- subset(veg.spp, select = c(vegplotiid, plantsym, plantsciname, planttypegroup, plantnativity, plantheightcllowerlimit, plantheightclupperlimit, livecanopyhtbottom, livecanopyhttop,
overstorydbhmin, overstorydbhmax, speciestraceamtflag,
speciescancovpct, speciescancovclass, speciescomppct, speciescompbywtpct,
akstratumcoverclass, akstratumcoverclasspct))
unique(x$speciescancovclass)
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct,# + ifelse(speciestraceamtflag,0.2,0),
# speciescancovclass %in% "trace" ~ 0.05,
# speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
# speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
# speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
# speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
# speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
# speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
# speciescancovclass %in% "51 to 75" ~ (50+75)/2,
# speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
# speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA))
rlang::last_error()
x <- x %>% mutate(cover = case_when(
speciescancovclass > 0 ~ 1,
TRUE ~ NA))
x <- x %>% mutate(cover = case_when(
speciescancovclass == 0 ~ 1,
TRUE ~ NA))
x %>%
mutate(new_var = case_when(speciescancovclass < 15 ~ 'low',
speciescancovclass < 25 ~ 'med',
TRUE ~ 'high'))
x <- x %>%
mutate(new_var = case_when(!is.na(akstratumcoverclasspct)  ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct,
TRUE ~ NA))
x <- x %>%
mutate(new_var = case_when(akstratumcoverclasspct > 0  ~ akstratumcoverclasspct,
speciescancovpct > 0 ~ speciescancovpct,
TRUE ~ NA))
x <- x %>%
mutate(new_var = case_when(akstratumcoverclasspct > 10  ~ 10,
akstratumcoverclasspct > 0 ~ 0,
TRUE ~ NA))
x$akstratumcoverclasspct
veg.plot <- soilDB::get_vegplot_from_NASIS_db()
veg.data <- soilDB::get_veg_data_from_NASIS_db()
veg.loc <- soilDB::get_vegplot_location_from_NASIS_db()
veg.spp <- soilDB::get_vegplot_species_from_NASIS_db()
veg.data.veg <- veg.data$veg
veg.data.trans <- veg.data$vegtransect
saveRDS(veg.plot, 'data/veg.plot.RDS')
saveRDS(veg.data, 'data/veg.data.RDS')
saveRDS(veg.loc, 'data/veg.loc.RDS')
saveRDS(veg.spp, 'data/veg.spp.RDS')
saveRDS(veg.data.veg, 'data/veg.data.veg.RDS')
saveRDS(veg.data.trans, 'data/veg.data.trans.RDS')
x <- subset(veg.spp, select = c(vegplotiid, plantsym, plantsciname, planttypegroup, plantnativity, plantheightcllowerlimit, plantheightclupperlimit, livecanopyhtbottom, livecanopyhttop,
overstorydbhmin, overstorydbhmax, speciestraceamtflag,
speciescancovpct, speciescancovclass, speciescomppct, speciescompbywtpct,
akstratumcoverclass, akstratumcoverclasspct))
x$akstratumcoverclasspct
x <- x$akstratumcoverclasspct %>%
mutate(new_var = case_when(akstratumcoverclasspct > 10  ~ 10,
akstratumcoverclasspct > 0 ~ 0,
TRUE ~ NA))
x <- x$akstratumcoverclasspct %>%
mutate(new_var = case_when(akstratumcoverclasspct > 10  ~ 'akstratumcoverclasspct',
akstratumcoverclasspct > 0 ~ '0',
TRUE ~ NA))
x <- x$akstratumcoverclasspct %>%
mutate(new_var = case_when(as.numeric(akstratumcoverclasspct) > 10  ~ 'akstratumcoverclasspct',
as.numeric(akstratumcoverclasspct) > 0 ~ '0',
TRUE ~ NA))
x <- x$akstratumcoverclasspct %>%
mutate(new_var = case_when(as.numeric(akstratumcoverclasspct) > 10  ~ 'akstratumcoverclasspct',
as.numeric(akstratumcoverclasspct) > 0 ~ '0',
TRUE ~ 'NA'))
x <- x %>% mutate(cover = case_when(
!is.na(akstratumcoverclasspct) ~ akstratumcoverclasspct,
!is.na(speciescancovpct) ~ speciescancovpct, + ifelse(speciestraceamtflag,0.2,0),
speciescancovclass %in% "trace" ~ 0.05,
speciescancovclass %in% "0.1 to 1%" ~ (0.1+1)/2,
speciescancovclass %in% "1.1 to 2%" ~ (1+2)/2,
speciescancovclass %in% "2 to 5%" ~ (2+5)/2,
speciescancovclass %in% "6 to 10%" ~ (5+10)/2,
speciescancovclass %in% "11 to 25%" ~ (10+25)/2,
speciescancovclass %in% "26 to 50%" ~ (25+50)/2,
speciescancovclass %in% "51 to 75" ~ (50+75)/2,
speciescancovclass %in% "76 to 95%" ~ (75+95)/2,
speciescancovclass %in% "> 95%" ~ (95+100)/2),
TRUE ~ NA)
